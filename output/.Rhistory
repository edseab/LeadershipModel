                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = <
<b>'@@9'</b>
>]
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab9;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab11;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: paste0('P*(1-I) + L*I + E*(d-1/n) - Cv - Cc')
      ") 
 grViz("digraph flowchart {
        # node definitions with substituted label text
        node [fontname = Helvetica, shape = rectangle]        
        tab1 [label = <
                   <b>Population size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@1-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab2 [label = <
                   <b>Group size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@2-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab3 [label = <
                   <b>Candidates</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@3-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab4 [label = <
           <b>Non Candidates</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@4-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab5 [label = <
           <b>Leader</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@5-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = <
<b>'@@9'</b>
>]
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab9;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab11;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: P*(1-I) + L*I + E*(d-1/n) - Cv - Cc
      ")
 grViz("digraph flowchart {
        # node definitions with substituted label text
        node [fontname = Helvetica, shape = rectangle]        
        tab1 [label = <
                   <b>Population size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@1-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab2 [label = <
                   <b>Group size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@2-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab3 [label = <
                   <b>Candidates</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@3-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab4 [label = <
           <b>Non Candidates</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@4-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab5 [label = <
           <b>Leader</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@5-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = '@@9']
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab9;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab11;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: paste0('P*(1-I) + L*I + E*(d-1/n) - Cv - Cc')
      ") 
 grViz("digraph flowchart {
        # node definitions with substituted label text
        node [fontname = Helvetica, shape = rectangle]        
        tab1 [label = <
                   <b>Population size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@1-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab2 [label = <
                   <b>Group size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@2-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab3 [label = <
                   <b>Candidates</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@3-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab4 [label = <
           <b>Non Candidates</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@4-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab5 [label = <
           <b>Leader</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@5-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = '@@9']
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab9;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab11;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: paste0('P*(1-I) + L*I + E*(d-1/n) - Cv - Cc')
      ") 
 grViz("digraph flowchart {
        # node definitions with substituted label text
        node [fontname = Helvetica, shape = rectangle]        
        tab1 [label = <
                   <b>Population size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@1-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab2 [label = <
                   <b>Group size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@2-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab3 [label = <
                   <b>Candidates</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@3-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab4 [label = <
           <b>Non Candidates</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@4-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab5 [label = <
           <b>Leader</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@5-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = '@@9']
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab9;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab11;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: paste0('P*(1-I) + L*I + E*(d-1/n) - Cv - Cc')
      ") 
 grViz("digraph flowchart {
        # node definitions with substituted label text
        node [fontname = Helvetica, shape = rectangle]        
        tab1 [label = <
                   <b>Population size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@1-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab2 [label = <
                   <b>Group size</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@2-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab3 [label = <
                   <b>Candidates</b>
                   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@3-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab4 [label = <
           <b>Non Candidates</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@4-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab5 [label = <
           <b>Leader</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@5-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab6 [label = <
           <b>Losers</b>
   <br ALIGN = 'CENTER' /> 
   <br/>
                     @@6-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab7 [label = <
           <b>Followers</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@8-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab8 [label = <
           <b>Acephalous</b>
   <br ALIGN = 'LEFT' /> 
   <br/>
                     @@7-1
                   <br ALIGN = 'CENTER' /> 
                  >]
        tab9 [label = '@@9']
        tab10 [label = '@@10']
        tab11 [label = '@@11']
        tab12 [label = '@@12']
        # edge definitions with the node IDs
        tab1 -> tab2-> tab3 -> tab5 -> tab12;
tab2 -> tab4 -> tab7 -> tab11;
tab3 -> tab6 -> tab10;
tab4 -> tab8 ->tab9;
      }
      [1]: paste0('N')
      [2]: paste0('n')
      [3]: paste0('v*n')
  [4]: paste0('(1-v)*n')
  [5]: paste0('1/(v*n)')
  [6]: paste0('(v*n-1)/(v*n)')
  [7]: paste0('v^n')
  [8]: paste0('(1-v^n)')
  [9]: paste0('P')
  [10]: paste0('P + L*I - E/n - Cv')
  [11]: paste0('P + L*I - E/n')
  [12]: paste0('P*(1-I) + L*I + E*(d-1/n) - Cv - Cc')
      ")
dbinom(0:7,7,0.5)
v<- 0.5
v^(0:4) +(1-v)^(4:0)
4*(v^(0:4) +(1-v)^(4:0))
4*(v^(0:4)*(1-v)^(4:0))
(v^(0:4)*(1-v)^(4:0)
v^(0:4)*(1-v)^(4:0)
v<-0.2
v^(0:4)*(1-v)^(4:0)
dbinom(0:4,4,0.5)
dbinom(0:4,4,0.5)*0:4
sum(dbinom(0:4,4,0.5)*0:4)
head(fulldb)
library(htmlwidgets)
head(graph_db)
fig <- plot_ly(graph_db, x=~L,y=~P,z=~equi_volunteering, color=~class,type="scatter3d") |>
  layout(scene=list(xaxis=list(title="Leadership"),
                    yaxis=list(title="Individual Production"),
zaxis=list(title="Percent volunteers at equilibrium")))
fig <- plot_ly(z=~surface) |> add_surface()
fig
fig <- plot_ly(graph_db, x=~L,y=~P,z=~equi_volunteering, color=~class,type="scatter3d") |>
  layout(scene=list(xaxis=list(title="Leadership"),
                    yaxis=list(title="Individual Production"),
zaxis=list(title="Percent volunteers at equilibrium")))
fig
htmlwidgets::saveWidget(partial_bundle(fig),'PxL_E2inv4.html')
graph_db <- create_model_df(P=seq(0,14,0.1),L=seq(0,14,0.1),E=2,
                      inv=0.4,Ecoef=0.9,
                      Lcost=0.5,volcost=0.5,
                      grpsz=5,N=100)
graph_db <- create_model_df(P=seq(0,14,0.1),L=seq(0,14,0.1),E=2,
                      inv=0.4,Ecoef=0.9,
                      Lcost=0.5,volcost=0.5,LL=0,
                      grpsz=5,N=100)
fig <- plot_ly(graph_db, x=~L,y=~P,z=~equi_volunteering, color=~class,type="scatter3d") |>
  layout(scene=list(xaxis=list(title="Leadership"),
                    yaxis=list(title="Individual Production"),
zaxis=list(title="Percent volunteers at equilibrium")))
fig
graph_db_noE <- create_model_df(P=seq(0,14,0.1),L=seq(0,14,0.1),E=0,
                      inv=0.4,Ecoef=1,
                      Lcost=0.5,volcost=0.5,LL=0,
                      grpsz=5,N=100)
fig <- plot_ly(graph_db_noE, x=~L,y=~P,z=~equi_volunteering, color=~class,type="scatter3d") |>
  layout(scene=list(xaxis=list(title="Leadership"),
                    yaxis=list(title="Individual Production"),
zaxis=list(title="Percent volunteers at equilibrium")))
htmlwidgets::saveWidget(partial_bundle(fig),'PxL_E0inv4.html')
q()
save.image("C:\\Users\\Ed\\Google Drive\\Backup\\Work 2 UNM\\R programs\\workspaces\\wheat21-09-20.RData")
q()
